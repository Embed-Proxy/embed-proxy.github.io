<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Embed Proxy</title>
<style>

*{transition: all .6s;}
body {margin: 0;padding: 0;display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: black;
    color: white;
    font-family: Arial, sans-serif;
    overflow: hidden;}
#container {position:relative;padding:56.25% 0 0 0;}
iframe {position:fixed;top:0;left:0;width:100%;height:100%;border:none;}
#enter-url{display:none;position:absolute;
  inset:0;
  margin:auto;
  width:fit-content;
  max-width:90vw;
  min-width:50vw;
  height:fit-content;
  padding:2rem;
  background:#111;
  border-radius:.5rem;
  text-align:center;
  box-sizing:border-box;}
#enter-url input{min-width:50%;padding:.7rem;margin:1rem 0;font-size:1.1rem;background:#222;border:1px solid #555;border-radius:.7rem;color:#fff;}
#enter-url input:hover{background:#000;border-color:#4300ed;}
#enter-url button{padding:.7rem 1.5rem 1.2rem;font-size:1.1rem;background:#333;border:1px solid;border-radius:1rem;color:#fff;}
#enter-url button:hover{background:#555;border-color:#4300ed;cursor:pointer;}
a{color:#888;font-size:.8rem;}
a:hover{color:#aaa}

</style>
</head>
<body>
<div id="container"><iframe allowfullscreen allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen"></iframe></div>
<div id="enter-url">
  No URL provided. Enter a YouTube or other embeddable URL below:<br>
  <input id="url-input" placeholder="https://youtu.be/..." autofocus><br>
  <button onclick="newEmbedUrl()">Load</button><br><br>
  <a href="https://github.com/Embed-Proxy/embed-proxy.github.io" target="_blank">Embed Proxy on GitHub</a>
</div>
<script>

const iframe = document.querySelector('iframe');
const raw = window.location.pathname.slice(1) + window.location.search;
const inputUrl = document.getElementById('url-input');
function newEmbedUrl() {const val = inputUrl.value.trim();
  if (val) location.href = '/' + val;}
if (!raw.trim()) {
  document.getElementById('enter-url').style.display = 'block';
  inputUrl.focus();
  inputUrl.addEventListener('keydown', e => { if (e.key === 'Enter') newEmbedUrl(); });
  throw new Error("No input");
}
const urlParams = new URLSearchParams(window.location.search);
function isPlaylistID(id) {return (id || '').split('?')[0].length > 11;}
// Full YouTube URL parsing
let cleaned = raw.replace(/^(https?:\/\/)?(www\.)?/gi, '').replace(/#.*$/, '');
let videoId = null;
let finalParams = new URLSearchParams();
finalParams.set('autoplay', '1');
// — youtu.be links (most common shared form)
if (cleaned.startsWith('youtu.be/')) {
  videoId = cleaned.split('youtu.be/')[1].split('?')[0].split('&')[0].split('#')[0];
  if (urlParams.has('t')) {
    const t = parseInt(urlParams.get('t'), 10);
    if (!isNaN(t)) finalParams.set('start', t);
  }
  if (urlParams.has('list')) finalParams.set('list', urlParams.get('list'));
  // Copy any other params (rel=0, mute=1, etc.)
  for (const [k, v] of urlParams) {
    if (!['t', 'list', 'v'].includes(k)) finalParams.set(k, v);
  }
}
// — Regular youtube.com/watch
else if (cleaned.startsWith('youtube.com/watch')) {
  const v = urlParams.get('v') || cleaned.split('v=')[1]?.split('&')[0];
  if (v) {
    const ids = v.split(',').filter(Boolean);
    if (ids.length > 1) {
      iframe.src = `https://www.youtube-nocookie.com/embed/?playlist=${ids.join(',')}&${finalParams.toString()}`;
      throw new Error("Done");
    }
    videoId = ids[0];
  }
  if (urlParams.has('list')) finalParams.set('list', urlParams.get('list'));
  if (urlParams.has('t')) {
    const t = parseInt(urlParams.get('t'), 10);
    if (!isNaN(t)) finalParams.set('start', t);
  }
}
// — Shorts
else if (cleaned.startsWith('youtube.com/shorts/')) {
  videoId = cleaned.split('shorts/')[1].split('?')[0];
}
// — Direct embed path
else if (cleaned.startsWith('youtube.com/embed/') || cleaned.startsWith('youtube-nocookie.com/embed/')) {
  const parts = cleaned.split('/embed/');
  if (parts[1]) videoId = parts[1].split('?')[0];
}
// — Playlist-only link
else if (urlParams.has('list') && !videoId) {
  const list = urlParams.get('list');
  if (isPlaylistID(list)) {
    iframe.src = `https://www.youtube-nocookie.com/embed/videoseries?list=${list}&${finalParams.toString()}`;
    throw new Error("Done");
  }
}
// Copy remaining params
for (const [k, v] of urlParams) {
  if (!['v', 't', 'list'].includes(k)) finalParams.set(k, v);
}
// Final embed URL construction
if (videoId || urlParams.has('list')) {
  if (!videoId && urlParams.has('list')) {
    // playlist without specific video
    iframe.src = `https://www.youtube-nocookie.com/embed/videoseries?list=${urlParams.get('list')}&${finalParams.toString()}`;
  } else {
    // normal video (with optional playlist context)
    iframe.src = `https://www.youtube-nocookie.com/embed/${videoId}?${finalParams.toString()}`;
  }
} else {iframe.src = raw;}// if not youtube, just use raw url
console.log(iframe.src);

</script>
</body>
</html>
